<html>
    <head>
        <script src="https://www.gstatic.com/charts/loader.js"></script>
        <style>
            * { line-height: 1.5; margin: 0; padding: 0; }
            body { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: repeat(5, min-content) 1fr; column-gap: 2rem; row-gap: 0.25rem; align-items: flex-start; }

            body > label { grid-column: 1 / -1; grid-row: 1 / -1; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); font-size: 1.5rem; font-weight: bold; text-align: center; }
            ::file-selector-button { font-size: 1.25rem; padding: 0.25rem; }

            body > h2 { grid-column: 1 / -1; text-align: center; }
            body > h3 { text-align: center; }

            body > .group { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 0.5rem; height: min-content; }
            body > .group > h3 { grid-column: span 2; text-align: center; padding: 0.25rem; }

            body > hr { grid-column: 1 / -1; }
        </style>
        <script>
            var results = null;
            google.charts.load('current', {'packages': ['corechart'] });

            function algorithmToString(algorithm)
            {
                switch (algorithm)
                {
                    case "BINARY_INSERTION": { return "Бинарными вставками"; }
                    case "BUBBLE_1": { return "Пузырьком с условием Айверсона 1"; }
                    case "BUBBLE_2": { return "Пузырьком с условием Айверсона 1+2"; }
                    case "BUBBLE": { return "Пузырьком"; }
                    case "COUNTING": { return "Подсчетом (устойчивая)"; }
                    case "HEAP": { return "Пирамидальная"; }
                    case "INSERTION": { return "Простыми вставками"; }
                    case "MERGE": { return "Слиянием"; }
                    case "QUICK": { return "Быстрая (первый опорный)"; }
                    case "RADIX": { return "Цифровой"; }
                    case "SELECTION": { return "Выбором"; }
                    case "SHELL_CIUR": { return "Шелла (последовательность Циура)"; }
                    case "SHELL": { return "Шелла (последовательность Шелла)"; }
                }
            }
            function typeToString(type)
            {
                switch (type)
                {
                    case "RANDOM_SMALL": { return "Случайные 0-5"; }
                    case "RANDOM_BIG": { return "Случайные 0-4000"; }
                    case "ALMOST_SORTED": { return "Почти отсортированный"; }
                    case "BACKWARDS_SORTED": { return "Обратно отсортированный"; }
                }
            }
            function drawTypeToString(key)
            {
                switch (key)
                {
                    case "time": return "Время работы (ns)";
                    case "operations": return "Количество операций";
                }
            }

            window.addEventListener("load", () =>
            {
                document.getElementById("input_file").addEventListener("change", ev =>
                {
                    let reader = new FileReader();
                    reader.addEventListener("load", e => { results = JSON.parse(e.currentTarget.result); setupCharts(); });
                    reader.readAsText(ev.target.files[0]);
                });
            });


            function setupCharts()
            {
                Array.from(document.body.children).forEach(e => e.remove());
                { let h2 = document.createElement("h2"); h2.innerText = "Выбор отображаемых графиков"; document.body.appendChild(h2); }
                for (let groupIndex = 0; groupIndex < results.time[Object.keys(results.time)[0]].length; groupIndex++)
                {
                    let group = document.createElement("div"); group.className = "group";
                    let h3 = document.createElement("h3"); h3.innerText = `Group ${groupIndex + 1}`; group.appendChild(h3);
                    let typesButton = document.createElement("button"); typesButton.innerText = "По видам"; group.appendChild(typesButton); typesButton.addEventListener("click", () => drawCharts(groupIndex, "types"));
                    let algorithmsButton = document.createElement("button"); algorithmsButton.innerText = "По алгоритмам"; group.appendChild(algorithmsButton); algorithmsButton.addEventListener("click", () => drawCharts(groupIndex, "algorithms"));
                    document.body.appendChild(group);
                }
                { document.body.appendChild(document.createElement("hr")); }
                { let h2 = document.createElement("h2"); h2.innerText = "Графики"; document.body.appendChild(h2); }
                { let h3 = document.createElement("h3"); h3.innerText = "По времени"; document.body.appendChild(h3); }
                { let h3 = document.createElement("h3"); h3.innerText = "По количеству элементарных операций"; document.body.appendChild(h3); }
                { let div = document.createElement("div"); div.id = "time"; document.body.appendChild(div); }
                { let div = document.createElement("div"); div.id = "operations"; document.body.appendChild(div); }
            }
            

            function draw(groupIndex, grouping, type)
            {
                const holder = document.getElementById("type");
                Array.from(holder.children).forEach(e => e.remove());
            }
            function drawCharts(groupIndex, grouping)
            {
                draw(groupIndex, grouping, "time");
                draw(groupIndex, grouping, "operations");
            }
        </script>
    </head>
    <body>
        <label>
            Upload data.json<br>
            <input type="file" accept=".json" id="input_file">
        </label>
    </body>
</html>